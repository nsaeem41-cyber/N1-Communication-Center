<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>N1 Pro - Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù„ÙƒÙŠØ© ğŸ˜Š</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --gold: #d4af37; --dark: #121212; --soft: #1e1e1e; --white: #ffffff; --danger: #ff4d4d; --success: #00c851; }
        body { font-family: 'Segoe UI', sans-serif; background-color: var(--dark); margin: 0; padding: 0; color: var(--white); direction: rtl; }
        .nav-n1 { background: linear-gradient(145deg, #1a1a1a, #000); padding: 15px; display: flex; justify-content: center; gap: 12px; border-bottom: 2px solid var(--gold); position: sticky; top: 0; z-index: 1000; }
        .nav-n1 a { color: var(--gold); text-decoration: none; font-weight: bold; padding: 8px 15px; border: 1px solid var(--gold); border-radius: 50px; font-size: 13px; transition: 0.3s; }
        .nav-n1 a:hover { background: var(--gold); color: var(--dark); }
        .header { padding: 30px; text-align: center; background: radial-gradient(circle, #2c2c2c 0%, #121212 100%); }
        .header h1 { color: var(--gold); font-size: 2rem; margin: 0; }
        .container { max-width: 1000px; margin: 20px auto; padding: 15px; }
        .card { background: var(--soft); border-radius: 20px; padding: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); margin-bottom: 20px; border: 1px solid rgba(212, 175, 55, 0.1); }
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab-btn { flex: 1; padding: 12px; border: none; border-radius: 12px; cursor: pointer; font-weight: bold; background: #2a2a2a; color: #888; transition: 0.3s; }
        .tab-btn.active { background: var(--gold); color: var(--dark); }
        .search-area { display: flex; gap: 10px; margin-bottom: 20px; }
        input { flex: 1; padding: 12px; background: #2a2a2a; border: 1px solid #3d3d3d; border-radius: 12px; color: white; outline: none; }
        .btn-main { background: var(--gold); color: var(--dark); border: none; padding: 12px 25px; border-radius: 12px; cursor: pointer; font-weight: bold; }
        .table-wrap { overflow-x: auto; border-radius: 12px; }
        table { width: 100%; border-collapse: collapse; background: #1e1e1e; }
        th { background: #2a2a2a; color: var(--gold); padding: 12px; font-size: 14px; border-bottom: 2px solid #333; }
        td { padding: 12px; text-align: center; border-bottom: 1px solid #2a2a2a; font-size: 13px; }
        .act-btn { padding: 6px 12px; border-radius: 8px; border: none; cursor: pointer; font-size: 11px; font-weight: bold; margin: 2px; }
        .b-edit { background: #3498db; color: white; }
        .b-del { background: var(--danger); color: white; }
        #status { display: none; padding: 12px; border-radius: 12px; text-align: center; margin-bottom: 15px; font-weight: bold; font-size: 14px; }
    </style>
</head>
<body>

<nav class="nav-n1">
    <a href="index.html">Ø§Ù„Ø¨ÙˆØ§Ø¨Ø© ğŸ </a>
    <a href="company_dashboard.html">Ø§Ù„Ø¬Ø±Ø¯ ğŸ“Š</a>
    <a href="admin_n1.html" style="background:var(--gold); color:var(--dark);">Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…Ù„ÙƒÙŠ âœ¨</a>
</nav>

<div class="header">
    <h1>Ù†Ø¸Ø§Ù… N1 - Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø±ÙƒØ²ÙŠØ© ğŸ˜Š</h1>
    <p style="color:#888; font-size:14px;">ØªØ­ÙƒÙ… ÙƒØ§Ù…Ù„ Ø¨Ø§Ù„Ø´Ø±ÙƒØ§Øª ÙˆØ§Ù„Ø·Ù„Ø¨Ø§Øª Ø¨ÙƒÙ„ Ø±Ù‚ÙŠ</p>
</div>

<div class="container">
    <div id="status"></div>
    <div class="card">
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('orders', this)">Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨ ğŸšš</button>
            <button class="tab-btn" onclick="switchTab('comps', this)">ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ù†Ø´Ø¢Øª ğŸ¢</button>
        </div>
        <div class="search-area">
            <input type="text" id="inpS" placeholder="Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø© Ø¹Ù† Ø£ÙŠ Ù…Ø¹Ù„ÙˆÙ…Ø©...">
            <button class="btn-main" onclick="loadCloud()">ØªØ­Ø¯ÙŠØ« ğŸ”„</button>
        </div>
        <div class="table-wrap">
            <table id="tbl">
                <thead id="thd"></thead>
                <tbody id="tbd"></tbody>
            </table>
        </div>
    </div>
</div>

<script>
    const API = 'https://sheetdb.io/api/v1/qzfkwfzcpbrsm';
    let mode = 'orders';

    async function loadCloud() {
        const b = document.getElementById('tbd');
        const h = document.getElementById('thd');
        const q = document.getElementById('inpS').value.toLowerCase();
        b.innerHTML = '<tr><td colspan="5">Ø¬Ø§Ø±ÙŠ Ø³Ø­Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨Ø©... ğŸ˜Š</td></tr>';
        try {
            const r = await fetch(API);
            const d = await r.json();
            b.innerHTML = '';
            if (mode === 'orders') {
                h.innerHTML = '<tr><th>Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨</th><th>Ø§Ù„Ù…ÙˆÙ‚Ø¹</th><th>Ø§Ù„Ø£Ø¬Ø±Ø©</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th></tr>';
                d.filter(o => o.phone && o.location && o.name.toLowerCase().includes(q)).reverse().forEach(o => {
                    b.innerHTML += `<tr><td style="color:var(--gold)">${o.name}</td><td>${o.location}</td><td style="font-weight:bold">${o.delivery}</td><td style="font-size:10px">${o.date || '-'}</td><td>
                        <button class="act-btn b-edit" onclick="editR('${o.id}','delivery','${o.delivery}')">ØªØ¹Ø¯ÙŠÙ„</button>
                        <button class="act-btn b-del" onclick="delR('${o.id}')">Ø­Ø°Ù</button></td></tr>`;
                });
            } else {
                h.innerHTML = '<tr><th>Ø§Ù„Ù…Ù†Ø´Ø£Ø©</th><th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th><th>Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th></tr>';
                d.filter(c => c.user && c.pass && c.name.toLowerCase().includes(q)).forEach(c => {
                    const ex = new Date() > new Date(c.expiry);
                    b.innerHTML += `<tr><td style="color:var(--gold)">${c.name}</td><td>${c.user}</td><td>${new Date(c.expiry).toLocaleDateString('ar-EG')}</td>
                        <td style="color:${ex ? 'var(--danger)':'var(--success)'}">${ex ? 'Ù…Ù†ØªÙ‡ÙŠ':'Ù†Ø´Ø·'}</td>
                        <td><button class="act-btn b-del" onclick="delR('${c.id}')">Ø¥Ù„ØºØ§Ø¡</button></td></tr>`;
                });
            }
        } catch (e) { b.innerHTML = '<tr><td colspan="5">Ù…Ø´Ø§ÙƒØ³Ø© Ø³Ø­Ø§Ø¨ÙŠØ©! ğŸ˜Š</td></tr>'; }
    }

    async function delR(id) {
        if(confirm('Ù…ØªØ£ÙƒØ¯Ø© Ù…Ù† Ø§Ù„Ø­Ø°Ù Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠ ÙŠØ§ Ø­Ø¨Ø© Ø§Ù„Ø³ÙƒØ± ğŸ˜ŠØŸ')) {
            msg('Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­Ø°Ù... ğŸ˜Š', 'var(--gold)');
            await fetch(`${API}/id/${id}`, { method: 'DELETE' });
            msg('ØªÙ… Ø§Ù„Ø­Ø°Ù Ø¨Ù†Ø¬Ø§Ø­ ğŸ˜Š', 'var(--success)');
            loadCloud();
        }
    }

    async function editR(id, f, v) {
        const n = prompt(`ØªØ¹Ø¯ÙŠÙ„ ${f}:`, v);
        if(n) {
            msg('Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„... ğŸ˜Š', 'var(--gold)');
            await fetch(`${API}/id/${id}`, { method: 'PATCH', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({data: {[f]: n}}) });
            msg('ØªÙ… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙƒÙ„ Ø±Ù‚ÙŠ ğŸ˜Š', 'var(--success)');
            loadCloud();
        }
    }

    function switchTab(m, b) {
        mode = m;
        document.querySelectorAll('.tab-btn').forEach(x => x.classList.remove('active'));
        b.classList.add('active');
        loadCloud();
    }

    function msg(m, c) {
        const s = document.getElementById('status');
        s.style.display = 'block'; s.innerText = m; s.style.background = c; s.style.color = 'black';
        setTimeout(() => s.style.display = 'none', 3000);
    }

    window.onload = loadCloud;
</script>
</body>
</html>
