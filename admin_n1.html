<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>N1 Pro - Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù„ÙƒÙŠ ğŸ˜Š</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --n1-gold: #d4af37; --n1-dark: #121212; --n1-soft: #1e1e1e; --n1-white: #ffffff; --n1-danger: #ff4d4d; --n1-success: #00c851; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--n1-dark); margin: 0; padding: 0; color: var(--n1-white); direction: rtl; }
        .n1-navbar { background: linear-gradient(145deg, #1a1a1a, #000); padding: 15px; display: flex; justify-content: center; gap: 15px; border-bottom: 2px solid var(--n1-gold); position: sticky; top: 0; z-index: 1000; box-shadow: 0 5px 20px rgba(0,0,0,0.5); }
        .n1-navbar a { color: var(--n1-gold); text-decoration: none; font-weight: bold; padding: 10px 20px; border: 1px solid var(--n1-gold); border-radius: 50px; font-size: 14px; transition: 0.4s; }
        .n1-navbar a:hover, .n1-navbar a.active { background: var(--n1-gold); color: var(--n1-dark); box-shadow: 0 0 15px var(--n1-gold); }
        .n1-header { padding: 40px 20px; text-align: center; background: radial-gradient(circle, #2c2c2c 0%, #121212 100%); }
        .n1-header h1 { color: var(--n1-gold); font-size: 2.5rem; margin: 0; text-shadow: 2px 2px 10px rgba(0,0,0,0.5); }
        .n1-container { max-width: 1100px; margin: -30px auto 50px; padding: 20px; }
        .n1-card { background: var(--n1-soft); border-radius: 25px; padding: 30px; box-shadow: 0 15px 35px rgba(0,0,0,0.4); border: 1px solid rgba(212, 175, 55, 0.1); margin-bottom: 30px; }
        .n1-tabs { display: flex; gap: 15px; margin-bottom: 25px; }
        .n1-tab-btn { flex: 1; padding: 15px; border: none; border-radius: 15px; cursor: pointer; font-weight: bold; background: #2a2a2a; color: #888; transition: 0.3s; font-size: 16px; }
        .n1-tab-btn.active { background: var(--n1-gold); color: var(--n1-dark); box-shadow: 0 5px 15px rgba(212, 175, 55, 0.3); }
        .search-bar { display: flex; gap: 10px; margin-bottom: 25px; }
        .n1-input { flex: 1; padding: 15px; background: #2a2a2a; border: 1px solid #3d3d3d; border-radius: 15px; color: white; outline: none; transition: 0.3s; }
        .n1-input:focus { border-color: var(--n1-gold); box-shadow: 0 0 10px rgba(212, 175, 55, 0.2); }
        .n1-btn { background: var(--n1-gold); color: var(--n1-dark); border: none; padding: 15px 30px; border-radius: 15px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        .n1-btn:hover { transform: translateY(-2px); opacity: 0.9; }
        .n1-table-wrapper { overflow-x: auto; border-radius: 15px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; background: #1e1e1e; }
        th { background: #2a2a2a; color: var(--n1-gold); padding: 15px; text-align: center; border-bottom: 2px solid #333; }
        td { padding: 15px; text-align: center; border-bottom: 1px solid #2a2a2a; font-size: 14px; }
        tr:hover { background: #252525; }
        .action-btn { padding: 8px 15px; border-radius: 10px; border: none; cursor: pointer; font-size: 12px; font-weight: bold; margin: 2px; }
        .btn-edit { background: #3498db; color: white; }
        .btn-del { background: var(--n1-danger); color: white; }
        #status { display: none; padding: 15px; border-radius: 15px; text-align: center; margin-bottom: 20px; font-weight: bold; }
    </style>
</head>
<body>

<nav class="n1-navbar">
    <a href="index.html">Ø§Ù„Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ğŸ </a>
    <a href="company_dashboard.html">Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª ğŸ“Š</a>
    <a href="n1_pro.html" class="active">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø°ÙƒÙŠØ© âœ¨</a>
</nav>

<div class="n1-header">
    <h1>Ù…Ø±ÙƒØ² ØªØ­ÙƒÙ… N1 Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠ ğŸ˜Š</h1>
    <p style="color: #888;">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†Ø´Ø¢Øª ÙˆØ§Ù„Ø·Ù„Ø¨Ø§Øª Ø¨ÙƒÙ„ Ø±Ù‚ÙŠ</p>
</div>

<div class="n1-container">
    <div id="status"></div>

    <div class="n1-card">
        <div class="n1-tabs">
            <button class="n1-tab-btn active" onclick="switchMode('orders', this)">Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨ ğŸšš</button>
            <button class="n1-tab-btn" onclick="switchMode('companies', this)">ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ù†Ø´Ø¢Øª ğŸ¢</button>
        </div>

        <div class="search-bar">
            <input type="text" id="n1Search" class="n1-input" placeholder="Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø© Ø¹Ù† Ø£ÙŠ Ø§Ø³Ù… Ø£Ùˆ Ø±Ù‚Ù…...">
            <button class="n1-btn" onclick="syncData()">ØªØ­Ø¯ÙŠØ« ÙˆØ¨Ø­Ø« ğŸ”„</button>
        </div>

        <div class="n1-table-wrapper">
            <table id="mainTable">
                <thead id="n1Head"></thead>
                <tbody id="n1Body"></tbody>
            </table>
        </div>
    </div>
</div>

<script>
    const API = 'https://sheetdb.io/api/v1/qzfkwfzcpbrsm';
    let currentMode = 'orders';

    function switchMode(mode, btn) {
        currentMode = mode;
        document.querySelectorAll('.n1-tab-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        syncData();
    }

    async function syncData() {
        const body = document.getElementById('n1Body');
        const head = document.getElementById('n1Head');
        const query = document.getElementById('n1Search').value.toLowerCase();
        body.innerHTML = '<tr><td colspan="5">Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨Ø©... ğŸ˜Š</td></tr>';

        try {
            const res = await fetch(API);
            const data = await res.json();
            body.innerHTML = '';

            if (currentMode === 'orders') {
                head.innerHTML = '<tr><th>Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨</th><th>Ø§Ù„Ù…ÙˆÙ‚Ø¹</th><th>Ø§Ù„Ø£Ø¬Ø±Ø©</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th></tr>';
                const orders = data.filter(o => o.phone && o.location && (o.name.toLowerCase().includes(query) || o.phone.includes(query)));
                orders.reverse().forEach(o => {
                    body.innerHTML += `<tr>
                        <td style="color:var(--n1-gold)">${o.name}</td>
                        <td>${o.location}</td>
                        <td style="font-weight:bold">${o.delivery} JOD</td>
                        <td style="font-size:11px; color:#666">${o.date || '-'}</td>
                        <td>
                            <button class="action-btn btn-edit" onclick="editRow('${o.id}', 'delivery', '${o.delivery}')">ØªØ¹Ø¯ÙŠÙ„</button>
                            <button class="action-btn btn-del" onclick="deleteRow('${o.id}')">Ø­Ø°Ù</button>
                        </td>
                    </tr>`;
                });
            } else {
                head.innerHTML = '<tr><th>Ø§Ù„Ù…Ù†Ø´Ø£Ø©</th><th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th><th>Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th></tr>';
                const comps = data.filter(c => c.user && c.pass && c.name.toLowerCase().includes(query));
                comps.forEach(c => {
                    const isExpired = new Date() > new Date(c.expiry);
                    body.innerHTML += `<tr>
                        <td style="color:var(--n1-gold)">${c.name}</td>
                        <td>${c.user}</td>
                        <td>${new Date(c.expiry).toLocaleDateString('ar-EG')}</td>
                        <td><span style="color:${isExpired ? 'var(--n1-danger)' : 'var(--n1-success)'}">${isExpired ? 'Ù…Ù†ØªÙ‡ÙŠ âŒ' : 'Ù†Ø´Ø· âœ…'}</span></td>
                        <td><button class="action-btn btn-del" onclick="deleteRow('${c.id}')">Ø¥Ù„ØºØ§Ø¡</button></td>
                    </tr>`;
                });
            }
        } catch (e) { body.innerHTML = '<tr><td colspan="5">ÙÙŠ Ù…Ø´Ø§ÙƒØ³Ø© Ø¨Ø§Ù„Ø³Ø­Ø§Ø¨Ø© ÙŠØ§ Ø¨Ø·Ø© ğŸ˜Š</td></tr>'; }
    }

    async function deleteRow(id) {
        if(confirm('ÙŠØ§ Ø­Ø¨Ø© Ø§Ù„Ø³ÙƒØ±ØŒ Ù…ØªØ£ÙƒØ¯Ø© Ù…Ù† Ø§Ù„Ø­Ø°Ù Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨Ø© ğŸ˜ŠØŸ')) {
            showNotify('Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø³Ø­ Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠ... ğŸ˜Š', 'var(--n1-gold)');
            await fetch(`${API}/id/${id}`, { method: 'DELETE' });
            showNotify('ØªÙ… Ø§Ù„Ø­Ø°Ù Ø¨ÙƒÙ„ Ø±Ù‚ÙŠ ğŸ˜Š', 'var(--n1-success)');
            syncData();
        }
    }

    async function editRow(id, field, oldVal) {
        const newVal = prompt(`ØªØ¹Ø¯ÙŠÙ„ ${field}:`, oldVal);
        if(newVal) {
            showNotify('Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª... ğŸ˜Š', 'var(--n1-gold)');
            await fetch(`${API}/id/${id}`, {
                method: 'PATCH',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({data: {[field]: newVal}})
            });
            showNotify('ØªÙ… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­ ğŸ˜Š', 'var(--n1-success)');
            syncData();
        }
    }

    function showNotify(msg, color) {
        const s = document.getElementById('status');
        s.style.display = 'block'; s.innerText = msg;
        s.style.background = color; s.style.color = 'black';
        setTimeout(() => s.style.display = 'none', 3000);
    }

    window.onload = syncData;
</script>
</body>
</html>
